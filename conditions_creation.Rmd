---
title: "conditions_creation"
author: "Nico"
date: "October 24, 2017"
output: html_document
---

```{r}
# Clean enviroment
rm(list = ls(all=TRUE))
```


```{r}
# Packages
if (!require('pacman')) install.packages('pacman'); library('pacman')
p_load(tidyverse)
```

# Items + pregunta

## Items

### Text item
```{r}
# path to responses folder
items_dir <- "materials/Items/"

# responses files
item_files <- dir(items_dir, pattern = ".txt")

# paths to each response file
item_files_path <- paste0(items_dir, item_files)

# list with responses as char strings
items <- lapply(item_files_path, 
                    function(x) readChar(con = x, nchars = file.info(x)$size))

# assing name to each response type
names(items) <- gsub(".txt", "", item_files)

# visualize item with line breaks
items
```

### Fact-box item

```{r}


```


## Pregunta

```{r}
# path to responses folder
question_dir <- "materials/Question/"

# responses files
question_files <- dir(question_dir)

# paths to each response file
question_files_path <- paste0(question_dir, question_files)

# list with responses as char strings
questions <- lapply(question_files_path, 
                    function(x) readChar(con = x, nchars = file.info(x)$size))

# assing name to each response type
names(questions) <- gsub(".txt", "", question_files)

# visualize question with line breaks
cat(questions[[1]])
```

## Items + pregunta
```{r}

# for (i in length(items)) {paste0(items[[i]], "\n", questions[[i]])}

problems <- lapply(items, function(x) paste0(x, lapply(questions, function(x) x)))

```

# Numbers sets
```{r}
# read csv with number
numbers_item <-
  read_csv("materials/Numbers/numbers_bayes.csv", col_types = cols())

```

# Create items

## Inputs
```{r}

# text fields to be replaced
field_to_replace <- c("prev_1", "prev_2", "hit_rate_1", "hit_rate_2", "false_positive_1", "false_positive_2")

# # replacements for text fields
field_replaces <- 
  c(paste0(
    numbers_item$prev_01[1]), paste0(numbers_item$prev_02[1])
    , paste0(numbers_item$hit_rate_01[1]), paste0(numbers_item$hit_rate_02[1])
    , paste0(numbers_item$false_positive_01[1]), paste0(numbers_item$false_positive_01[1]))

# # create frame with field to be replaced and replacements
numbers_to_text <- 
  tibble("field_to_replace" = field_to_replace, "field_replaces" = field_replaces)


```

## Create items (combine items with numbers)
```{r}

for (i in 1:length(problems)) {
  # i=1
  
  # item to loop
  item_to_number <- problems[[i]]
  
  # loop to number
  for (j in 1:nrow(numbers_to_text)) {
  # j=6
    
  item_to_number = 
    gsub(numbers_to_text$field_to_replace[j], numbers_to_text$field_replaces[j], item_to_number)
  
}
  # store numbered item
  problems[[i]] <- item_to_number
  
}

# final item
problems
```

# Respuesta
```{r}

# path to responses folder
response_types_dir <- "materials/Response_type/"

# responses files
response_type_files <- dir(response_types_dir)

# paths to each response file
response_type_files_path <- paste0(response_types_dir, response_type_files)

# list with responses as char strings
responses <- lapply(response_type_files_path, 
                    function(x) readChar(con = x, nchars = file.info(x)$size))

# assing name to each response type
names(responses) <- gsub(".txt", "", response_type_files)
```

# Combine problem with questions
```{r}
problem_questions <- lapply(problems, 
                            function(x) paste0(x, lapply(responses, function(x) x)))



cat_print <- function(x) {
  cat(paste0("\n\n\n", x))
}

cat(unlist(problem_questions))


```

# Follow-up 
```{r}

```


# Follow-up risk






























