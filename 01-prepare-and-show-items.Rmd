```{r item_preparation, include=FALSE}

# Item preparation
  source("scripts/item_preparation.R")

# Read images
# Fact-box
  # Directory
  fact_box_dir <- "materials/Presentation_format/fbpi/output/"
  # Fact-box img files
  fact_box_imgs <- dir(fact_box_dir)
  
# New paradigm
  # Directory
  new_paradigm_dir <- "materials/Presentation_format/nppi/output/"
  # Fact-box img files
  new_paradigm_imgs <- dir(new_paradigm_dir)
  
  # Function for displaying items
  source("functions/print_cat_items.R")
  source("functions/remove_placeholders.R")
  source("functions/asterik_name_remover.R")
  
```
    
# Breast Cancer Items

## Low normative PPV

### NF ABSOLUTE

```{r, results='asis', echo=FALSE, ca_nfab_low}
print_cat_items(problems_numbered_ordered_responses, "ca_nfab_ppvlow", "item")
```

### PR ABSOLUTE

```{r, results='asis', echo=FALSE, ca_prab_low}
print_cat_items(problems_numbered_ordered_responses,"ca_prab_ppvlow", "item")
```

### PR RELATIVE

```{r, results='asis', echo=FALSE, ca_prre_low}
print_cat_items(problems_numbered_ordered_responses,"ca_prre_ppvlow", "item")
```

### PF ABSOLUTE

```{r, results='asis', echo=FALSE, ca_pfab_low}
print_cat_items(problems_numbered_ordered_responses,"ca_pfab_ppvlow", "item")
```

### FB PICTORIAL

**ca_fbpi_low_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
# TODO: add a print/cat (default), print, cat option?
fb_ca_low <- readPNG(paste0(fact_box_dir, grep(".*ca_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response type
cat(remove_placeholders(responses_pic[["gi"]], "item"))
# Sep
cat("\n****************************\n")
```


  
**ca_fbpi_low_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_ca_low <- readPNG(paste0(fact_box_dir, grep(".*ca_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response type
cat(remove_placeholders(responses_pic[["gs"]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_fbpi_low_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_ca_low <- readPNG(paste0(fact_box_dir, grep(".*ca_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(cat(remove_placeholders(responses_pic$sg[[grep("cancer", responses_pic$sg)]], "item")))
# Sep
cat("\n****************************\n")
```
  
**ca_fbpi_low_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_ca_low <- readPNG(paste0(fact_box_dir, grep(".*ca_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses_pic[["ss"]], "item"))
```


### NP PICTORIAL

**ca_nppi_low_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_low", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Image
np_ca_low <- readPNG(paste0(new_paradigm_dir, grep(".*ca_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_nppi_low_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_low", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Image
np_ca_low <- readPNG(paste0(new_paradigm_dir, grep(".*ca_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_nppi_low_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_low", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Image
np_ca_low <- readPNG(paste0(new_paradigm_dir, grep(".*ca_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(cat(remove_placeholders(responses_pic$sg[[grep("cancer", responses_pic$sg)]], "item")))
# Sep
cat("\n****************************\n")
```
  
**ca_nppi_low_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_low", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Image
np_ca_low <- readPNG(paste0(new_paradigm_dir, grep(".*ca_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_low)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
```


## High normative PPV

### NF ABSOLUTE

```{r, results='asis', echo=FALSE, ca_nfab_high}
print_cat_items(problems_numbered_ordered_responses,"ca_nfab_ppvhigh", "item")
```

### PR ABSOLUTE

```{r, results='asis', echo=FALSE, ca_prab_high}
print_cat_items(problems_numbered_ordered_responses,"ca_prab_ppvhigh", "item")
```

### PR RELATIVE

```{r, results='asis', echo=FALSE, ca_prre_high}
print_cat_items(problems_numbered_ordered_responses,"ca_prre_ppvhigh", "item")
```

### PF ABSOLUTE

```{r, results='asis', echo=FALSE, ca_pfab_high}
print_cat_items(problems_numbered_ordered_responses,"ca_pfab_ppvhigh", "item")

```

### FB PICTORIAL

**ca_fbpi_high_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Image
fb_ca_high <- readPNG(paste0(fact_box_dir, grep(".*ca_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_fbpi_high_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Image
fb_ca_high <- readPNG(paste0(fact_box_dir, grep(".*ca_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% 
  asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_fbpi_high_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_ca_high <- readPNG(paste0(fact_box_dir, grep(".*ca_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(cat(remove_placeholders(responses_pic$sg[[grep("cancer", responses_pic$sg)]], "item")))
# Sep
cat("\n****************************\n")
```
  
**ca_fbpi_high_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_ca_high <- readPNG(paste0(fact_box_dir, grep(".*ca_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
# Sep
cat("\n****************************\n")
```

### NP PICTORIAL

**ca_nppi_high_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_ca_high <- readPNG(paste0(new_paradigm_dir, grep(".*ca_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_nppi_high_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_ca_high <- readPNG(paste0(new_paradigm_dir, grep(".*ca_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```
  
**ca_nppi_high_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_ca_high <- readPNG(paste0(new_paradigm_dir, grep(".*ca_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(cat(remove_placeholders(responses_pic$sg[[grep("cancer", responses_pic$sg)]], "item")))
# Sep
cat("\n****************************\n")
```
  
**ca_nppi_high_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "ca_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_ca_high <- readPNG(paste0(new_paradigm_dir, grep(".*ca_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_ca_high)
# Question
print_cat_items(questions, "ca", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
```

# Trisomy 21 Items

## Low normative PPV

### NF ABSOLUTE

```{r, results='asis', echo=FALSE, pr_nfab_low}
print_cat_items(problems_numbered_ordered_responses,"pr_nfab_ppvlow", "item")
```

### PR ABSOLUTE

```{r, results='asis', echo=FALSE, pr_prab_low}
print_cat_items(problems_numbered_ordered_responses,"pr_prab_ppvlow", "item")
```

### PR RELATIVE

```{r, results='asis', echo=FALSE, pr_prre_low}
print_cat_items(problems_numbered_ordered_responses,"pr_prre_ppvlow", "item")
```

### PF ABSOLUTE

```{r, results='asis', echo=FALSE, pr_pfab_low}
print_cat_items(problems_numbered_ordered_responses,"pr_pfab_ppvlow", "item")
```

### FB PICTORIAL

**pr_fbpi_low_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_low <- readPNG(paste0(fact_box_dir, grep(".*pr_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_fbpi_low_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_low <- readPNG(paste0(fact_box_dir, grep(".*pr_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_fbpi_low_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_low <- readPNG(paste0(fact_box_dir, grep(".*pr_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses_pic$sg[[grep("Trisomy", responses_pic$sg)]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_fbpi_low_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_low <- readPNG(paste0(fact_box_dir, grep(".*pr_low.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
```

### NP PICTORIAL

**pr_nppi_low_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_low <- readPNG(paste0(new_paradigm_dir, grep(".*pr_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_nppi_low_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_low <- readPNG(paste0(new_paradigm_dir, grep(".*pr_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_nppi_low_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_low <- readPNG(paste0(new_paradigm_dir, grep(".*pr_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses_pic$sg[[grep("Trisomy", responses_pic$sg)]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_nppi_low_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_low", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_low <- readPNG(paste0(new_paradigm_dir, grep(".*pr_low.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_low)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
```


## High normative PPV

### NF ABSOLUTE

```{r, results='asis', echo=FALSE, pr_nfab_high}
print_cat_items(problems_numbered_ordered_responses,"pr_nfab_ppvhigh", "item")
```

### PR ABSOLUTE

```{r, results='asis', echo=FALSE, pr_prab_high}
print_cat_items(problems_numbered_ordered_responses,"pr_prab_ppvhigh", "item")
```

### PR RELATIVE

```{r, results='asis', echo=FALSE, pr_prre_high}
print_cat_items(problems_numbered_ordered_responses,"pr_prre_ppvhigh", "item")
```

### PF ABSOLUTE

```{r, results='asis', echo=FALSE, pr_pfab_high}
print_cat_items(problems_numbered_ordered_responses,"pr_pfab_ppvhigh", "item")
```

### FB PICTORIAL

**pr_fbpi_high_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_high <- readPNG(paste0(fact_box_dir, grep(".*pr_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_fbpi_high_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_high <- readPNG(paste0(fact_box_dir, grep(".*pr_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```

**pr_fbpi_high_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_high <- readPNG(paste0(fact_box_dir, grep(".*pr_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses_pic$sg[[grep("Trisomy", responses_pic$sg)]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_fbpi_high_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(fbpi_context, "high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
fb_pr_high <- readPNG(paste0(fact_box_dir, grep(".*pr_high.*", fact_box_imgs, value = TRUE)))
grid.raster(fb_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
```

### NP PICTORIAL

**pr_nppi_high_gi**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_high <- readPNG(paste0(new_paradigm_dir, grep(".*pr_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[1]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_nppi_high_gs**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_high <- readPNG(paste0(new_paradigm_dir, grep(".*pr_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[2]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_nppi_high_sg**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_high <- readPNG(paste0(new_paradigm_dir, grep(".*pr_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses_pic$sg[[grep("Trisomy", responses_pic$sg)]], "item"))
# Sep
cat("\n****************************\n")
```
  
**pr_nppi_high_ss**  
```{r, echo=FALSE, results='asis'}
# Context
print_cat_items(nppi_context, "pr_high", "item", "print") %>% asterik_name_remover() %>% cat()
# Image
np_pr_high <- readPNG(paste0(new_paradigm_dir, grep(".*pr_high.*", new_paradigm_imgs, value = TRUE)))
grid.raster(np_pr_high)
# Question
print_cat_items(questions, "pr", "item", "print") %>% asterik_name_remover() %>% cat()
# Response
cat(remove_placeholders(responses[[4]], "item"))
```

# Comprehension questions

```{r comprehension, echo=FALSE, results='asis'}
source("scripts/comprehension_preparing.R")

invisible(lapply(comprehension_questions, lapply, cat))
```


# Follow-up questions

```{r follow-up, echo=FALSE, results='asis'}
source("scripts/follow_up_preparing.R")

# invisible(lapply(fu_questions, lapply, cat))
invisible(lapply(fu_questions, function(x) {cat(x); cat("\n****************************\n")}))
```


# Scales

```{r scales, echo=FALSE, results='asis'}
source("scripts/scales_preparing.R")

invisible(lapply(scales_questions, lapply, cat))
```

# Item export

```{r}
source("scripts/export2qualtrics.R")
```

